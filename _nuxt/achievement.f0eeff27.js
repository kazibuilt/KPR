var e=Object.defineProperty,t=(t,i,s)=>(((t,i,s)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s})(t,"symbol"!=typeof i?i+"":i,s),s);import{C as i}from"./index.6c8f1534.js";import{T as s}from"./three-object.387dbe05.js";import{a as o,c as n,O as a,V as r}from"./three.module.522d90d0.js";import{D as l,x as c}from"./dom-component.59802661.js";import{g as d}from"./utils.bef7071b.js";import{as as h}from"./entry.40e762a9.js";import{u as p}from"./citizen-store.87c6b519.js";import{D as m}from"./dom-element.35f09cfb.js";import{a as u}from"./index-default.25f36e61.js";class f extends a{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new r(.5,.5),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const v=new o,y=new n,g=new n,C=new o,w=new o;class b{constructor(e={}){const t=this;let i,s,o,n;const a={objects:new WeakMap},r=void 0!==e.element?e.element:document.createElement("div");function l(e,i,s){if(e.isCSS2DObject){v.setFromMatrixPosition(e.matrixWorld),v.applyMatrix4(g);const l=!0===e.visible&&v.z>=-1&&v.z<=1&&!0===e.layers.test(s.layers);if(e.element.style.display=!0===l?"":"none",!0===l){e.onBeforeRender(t,i,s);const a=e.element;a.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(v.x*o+o)+"px,"+(-v.y*n+n)+"px)",a.parentNode!==r&&r.appendChild(a),e.onAfterRender(t,i,s)}const d={distanceToCameraSquared:c(s,e)};a.objects.set(e,d)}for(let t=0,o=e.children.length;t<o;t++)l(e.children[t],i,s)}function c(e,t){return C.setFromMatrixPosition(e.matrixWorld),w.setFromMatrixPosition(t.matrixWorld),C.distanceToSquared(w)}r.style.overflow="hidden",this.domElement=r,this.getSize=function(){return{width:i,height:s}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),y.copy(t.matrixWorldInverse),g.multiplyMatrices(t.projectionMatrix,y),l(e,e,t),function(e){const t=function(e){const t=[];return e.traverse((function(e){e.isCSS2DObject&&t.push(e)})),t}(e).sort((function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return a.objects.get(e).distanceToCameraSquared-a.objects.get(t).distanceToCameraSquared})),i=t.length;for(let s=0,o=t.length;s<o;s++)t[s].element.style.zIndex=i-s}(e)},this.setSize=function(e,t){i=e,s=t,o=i/2,n=s/2,r.style.width=e+"px",r.style.height=t+"px"}}}class x extends i{constructor(){super(...arguments),t(this,"options",{template:({props:e,options:t,context:i})=>c`<div class="itemAchievement itemAchievement--${t.type} ${t.difficulty}" ?achieved=${e.achieved}
    @pointerenter=${i.onPointerEnter} @pointerleave=${i.onPointerLeave} @click=${i.onClick}>"
    <div class="itemAchievement__symbol">
        <div class="glow" data-ui="glow"></div>
        ${"mark"==t.type?c`<svg width="77" height="77" viewBox="0 0 77 77" fill="none">
            <path class="path1" data-ui="path1"
                d="M33.8088 7.60586C36.6017 5.99335 40.0428 5.99335 42.8357 7.60586L62.6667 19.0553C65.4597 20.6678 67.1802 23.6478 67.1802 26.8729V49.7717C67.1802 52.9967 65.4597 55.9767 62.6667 57.5893L42.8357 69.0387C40.0428 70.6512 36.6017 70.6512 33.8088 69.0387L13.9778 57.5893C11.1849 55.9767 9.46434 52.9967 9.46434 49.7717V26.8729C9.46434 23.6478 11.1849 20.6678 13.9778 19.0553L33.8088 7.60586Z" />
            <g class="g1" transform-origin="50%" transform="${e.achieved?null:" scale(0.9)"}">
                <path class="path0" data-ui="path0"
                    d="M33.9865 2.60586C36.7795 0.993349 40.2205 0.993349 43.0135 2.60586L67.3285 16.6441C70.1214 18.2567 71.842 21.2367 71.842 24.4617V52.5383C71.842 55.7633 70.1214 58.7434 67.3285 60.3559L43.0135 74.3941C40.2205 76.0067 36.7795 76.0067 33.9865 74.3941L9.67151 60.3559C6.87855 58.7434 5.15802 55.7633 5.15802 52.5383V24.4617C5.15802 21.2367 6.87855 18.2567 9.67151 16.6441L33.9865 2.60586Z"
                    stroke-width="2" />
            </g>
        </svg>`:c`<svg width="66" height="78" viewBox="0 0 66 78" fill="none">
            <!-- <g class="g1" transform="${e.achieved?null:" scale(1.15)"}" transform-origin="50%"> -->
            <g class="g1" transform-origin="50%">
                <path class="path0" data-ui="path0"
                d="M59.9365 1.50927C62.6979 1.50927 64.9365 3.74784 64.9365 6.50927L64.9365 55.1894C64.9365 56.9398 64.0212 58.5628 62.5233 59.4683L36.2934 75.3253C34.7434 76.2623 32.808 76.2879 31.2339 75.3922L4.18364 60.0005C2.62129 59.1115 1.65638 57.4523 1.65638 55.6548L1.65638 6.50927C1.65638 3.74784 3.89496 1.50927 6.65638 1.50927L59.9365 1.50927Z"
                stroke-width="2" stroke-miterlimit="10" />
            </g>
            <path class="path1" data-ui="path1"
                d="M56.417 6.02617C58.6261 6.02617 60.417 7.81703 60.417 10.0262L60.417 52.3642C60.417 53.7624 59.6869 55.0591 58.4914 55.7842L35.7272 69.592C34.4848 70.3456 32.9314 70.3661 31.6695 69.6457L8.1937 56.2434C6.94662 55.5314 6.17687 54.2056 6.17687 52.7696L6.17687 10.0262C6.17687 7.81703 7.96773 6.02617 10.1769 6.02617L56.417 6.02617Z" />
        </svg>
        `}
        <img class="icon" data-ui='icon' src="${t.icon.filename}" alt="">
    </div>
    <div class="itemAchievement__infos" data-ui="infos">
        <p class="name">${t.title}</p>
        <p class="difficulty">${t.difficulty}</p>
    </div>
</div>`,difficulty:"common",type:"mark"}),t(this,"props",{size:e=>e.achieved?76:66,w:e=>e.size,h:e=>e.size,align:"left",achieved:!1,cDifficulty:""}),t(this,"propsAnim",{alpha:0,blink:0}),t(this,"onPointerEnter",(()=>{var e;const{achieved:t}=this.props,{path0:i,path1:s,glow:o,infos:n,icon:a}=this.ui;null==(e=this.tlOver)||e.kill();const r=this.tlOver=h.timeline({}).to(i,{scale:1,duration:.4,ease:"power3.out"},0).to([s,a],{scale:1,duration:.45,ease:"power3.out"},.04).to(n.children,{y:0,opacity:1,duration:.4,ease:"power2.out",stagger:.04},0);t&&r.to(o,{scale:1.1,opacity:.38,ease:"sine.out",duration:.6},0)})),t(this,"onPointerLeave",(()=>{var e;const{achieved:t}=this.props,{path0:i,path1:s,glow:o,infos:n,icon:a}=this.ui;null==(e=this.tlOver)||e.kill();const r=this.tlOver=h.timeline({}).to(i,{scale:.9,duration:.45,ease:"power3.out"},.04).to([s,a],{scale:.9,duration:.4,ease:"power3.out"},0).to(n.children,{y:2,opacity:0,duration:.4,ease:"power2.out",stagger:{from:"end",each:.05}},0);t&&r.to(o,{scale:1,opacity:.2,ease:"sine.out",duration:.6},0)})),t(this,"onClick",(()=>this.openAchievement())),t(this,"openAchievement",(()=>{const{type:e}=this.options,t=p(),i="mark"===e,s=i?"achievement_id":"badge_id",o=i?this.options.achievement_id:this.options.badge_id,n=t.achievements.all.find((e=>e[s]==o));t.setAchievementDetail(n)}))}async onSetup({props:e,options:t}){this.object2d=new f(this.el);const{path0:i,path1:s,glow:o,infos:n,icon:a}=this.ui;h.set([i,s,a],{scale:.9,transformOrigin:"50%"}),h.set(n.children,{y:2,opacity:0}),h.set(o,{scale:1,opacity:.2})}onAfterSetup(){const{difficulty:e}=this.options;this.props.cDifficulty=d(e)}setCDifficulty(e){this.el.style.setProperty("--cl-difficulty",e)}setV(e){e?this.object.add(this.object2d):this.object.remove(this.object2d),this.animateInOut(e)}animateInOut(e){const t=+e;h.fromTo(this.el,{alpha:+!e},{alpha:t,delay:.1*Math.random(),duration:.3,ease:"power3.out"})}}u(x,[l,m,s]);const j=Object.freeze(Object.defineProperty({__proto__:null,default:x},Symbol.toStringTag,{value:"Module"}));export{b as C,x as M,f as a,j as b};
